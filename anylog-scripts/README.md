# AnyLog Support 
The following scripts are intended to help getting data from Xompass into the [AnyLog Network](https://github.com/AnyLog-co/AnyLog-Network).

The code iteslf takes data generated by Xompass (stored in $HOME/xompass-pi-webapi-browser/output_data) and merge them into larger files (based on user defined size). When a file is ready to be sent into the AnyLog Network it is copied into a "ready" directory that AnyLog is aware of and takes files from in order to store on the network. 

# Sample Data
The data original comes as:  

```
{
   "CategoryNames": [
                "Ping"
   ],
   "ParentElement": "68ae8bef-92e1-11e9-b465-d4856454f4ba",
   "DataReferencePlugIn": "PI Point",
   "ConfigString": "\\\\XOMPASS-LITSL?fb26ea2c-ee4f-4554-9cdd-67d2c48004eb\\CATALYST 3500XL.Ping?18",
   "ParentElementTemplate": "Basic Network Element",
   "WebId": "F1AbEfLbwwL8F6EiShvDV-QH70A74uuaOGS6RG0ZdSFZFT0ug4FckGTrxdFojNpadLPwI4gWE9NUEFTUy1MSVRTTFxMSVRTQU5MRUFORFJPXDc3NyBEQVZJU1xQT1AgUk9PTVxDQVRBTFlTVCAzNTAwWEx8UElORw",
   "Name": "Ping",
   "Path": "\\\\XOMPASS-LITSL\\LitSanLeandro\\777 Davis\\POP Room\\Catalyst 3500XL|Ping",
   "Value": 1,
   "Timestamp": "2020-10-11T22:42:11.0690002Z"
}
```

The data is stored as follows:
```
{
   "parentelement": "68ae8bef-92e1-11e9-b465-d4856454f4ba",
   "webid": "F1AbEfLbwwL8F6EiShvDV-QH70A74uuaOGS6RG0ZdSFZFT0ug4FckGTrxdFojNpadLPwI4gWE9NUEFTUy1MSVRTTFxMSVRTQU5MRUFORFJPXDc3NyBEQVZJU1xQT1AgUk9PTVxDQVRBTFlTVCAzNTAwWEx8UElORw",
   "device_name": "Catalyst 3500XL",
   "value": 1,
   "timestamp": "2020-10-11T22:42:11.0690002Z"
}
```
# Execute Process 
## Options

```
python3 get_data --help 
:positional arguments:
   prep_dir              directory where data is prepped
   watch_dir             publisher data node
:optional arguments:
   -h, --help                  show this help message and exit
   -f, --file-size FILE_SIZE   file size in MB                                               (default: 1)
   -t, --timeout   TIMEOUT     When data isn't available how long to wait before timing out  (default: 60)
   -b, --dbms      DBMS        database to store data in                                     (default: lsl_demo)
   -d, --data-dir  DATA_DIR    directory containg origin data                                (default: $HOME/xompass-pi-webapi-browser/output_data)
```

## Sample Call 
```
python3 get_data $HOME/AnyLog-Network/data/prep $HOME/AnyLog-Network/data/watch -f 0.01 -t 30 -b lsl_demo -d $HOME/xompass-pi-webapi-browser/output_data
``` 
